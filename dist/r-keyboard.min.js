!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.RKeyboard=n():e.RKeyboard=n()}(window,function(){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=1)}([function(e,n){Object.values=Object.values||function(e){return Object.keys(e).map(function(n){return e[n]})}},function(e,n,t){"use strict";t.r(n);t(0);var r=function(e){return null!=e},o=function(e){return[].concat(new Set(e))},i=[],a=[],u=[],c=function(e){var n=e.keyCode;return r(n)?n:e.which},f=function(e){var n=c(e);!function(e){for(var n=i.length-1;n>=0;n--)if(i[n]===e)return void i.splice(n,1)}(n),function(e){u.forEach(function(n){n.keyCodes.includes(e)&&n.callback(e)})}(n)},l=function(e){return i.includes(e)};document.addEventListener("keydown",function(e){var n=c(e);l(n)||(function(e){i.push(e)}(n),function(e){a.forEach(function(n){n.keyCodes.includes(e)&&n.callback(e)})}(n))}),document.addEventListener("keyup",f),window.addEventListener("blur",function(){i.forEach(function(e){return f({keyCode:e,preventDefault:function(){}})})});var s=function(e,n){var t=(void 0===n?{}:n).preventDefault,r=[],o=[],i=!1,f=function(n){e.includes(c(n))&&n.preventDefault()};return t&&(document.addEventListener("keydown",f),document.addEventListener("keyup",f)),{on:function(n,c){switch(i&&t&&(document.addEventListener("keydown",f),document.addEventListener("keyup",f)),n){case"keydown":!function(n){for(var t=r.length-1;t>=0;t--)if(r[t].callback===n)return;var o={keyCodes:e,callback:n};r.push(o),a.push(o)}(c);break;case"keyup":!function(n){for(var t=o.length-1;t>=0;t--)if(o[t].callback===n)return;var r={keyCodes:e,callback:n};o.push(r),u.push(r)}(c)}},off:function(e,n){switch(e){case"keydown":!function(e){for(var n=r.length-1;n>=0;n--)if(r[n].callback===e){var t=a.indexOf(r[n]);return r.splice(n,1),void a.splice(t,1)}}(n);break;case"keyup":!function(e){for(var n=o.length-1;n>=0;n--)if(o[n].callback===e){var t=u.indexOf(o[n]);return o.splice(n,1),void u.splice(t,1)}}(n)}},close:function(){!function(){for(var e=r.length-1;e>=0;e--){var n=a.indexOf(r[e]);r.splice(e,1),a.splice(n,1)}for(var t=o.length-1;t>=0;t--){var i=u.indexOf(o[t]);o.splice(t,1),u.splice(i,1)}}(),document.removeEventListener("keydown",f),document.removeEventListener("keyup",f),i=!0}}},v={KEY_MAP:{8:"Back",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"Caps",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete",48:"Num0",49:"Num1",50:"Num2",51:"Num3",52:"Num4",53:"Num5",54:"Num6",55:"Num7",56:"Num8",57:"Num9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"Window",92:"Window",93:"Select",96:"Num0",97:"Num1",98:"Num2",99:"Num3",100:"Num4",101:"Num5",102:"Num6",103:"Num7",104:"Num8",105:"Num9",106:"Multiply",107:"Add",109:"Subtract",110:"DecimalPoint",111:"Divide",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"NumLock",145:"ScrollLock",186:"SemiColon",187:"Equal",188:"Comma",189:"Dash",190:"Point",191:"Slash",192:"BackTick",219:"OpenBracket",220:"BackSlash",221:"CloseBracket",223:"SingleQuote"},GROUPINGS:{Nums:["Num0","Num1","Num2","Num3","Num4","Num5","Num6","Num7","Num8","Num9"],Directions:["Up","Down","Left","Right"],Letters:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]},DEFAULT_PROPAGATE_VALUE:!0,DEFAULT_COMBINE_VALUE:!0,DEFAULT_REEMIT_VALUE:500,DEFAULT_PREVENT_DEFAULT:!1},p=function(e){void 0===e&&(e={});var n=e.keyMap||v.KEY_MAP,t=e.propagate||v.DEFAULT_PROPAGATE_VALUE,a=e.preventDefault||v.DEFAULT_PREVENT_DEFAULT,u=e.reEmit||v.DEFAULT_REEMIT_VALUE,c=[],f=[],l=s(Object.keys(n).map(function(e){return+e}),{preventDefault:a}),p={},d={},y={},m=new WeakMap,h=function(e){var n=p[e]&&p[e].length;return n?p[e][n-1].slice(0):[]},k=function(e,n,t){for(var r=h(n),o=!0,i=r.length-1;i>=0;i--){var a={stopPropagation:function(){i=-1}},u=r[i];(o||h(n).indexOf(u)>=0)&&(u.call(a,{type:e,keyName:n,keyCode:t}),o=!1)}},g=function(e){var t=n[e];k("keydown",t,e),function(e,t){if(f.includes(t)){var r=[];c.forEach(function(e){var n=e.indexOf(t);n>=0&&r.push([[].concat(e).splice(n,1),[],[e]])});for(var o=i.length-1;o>=0;o--)i[o]!==e&&r.forEach(function(t){var r=t[0].indexOf(n[e]);r>=0&&(t[0].splice(r,1),t[1][r]=e)});r.forEach(function(e){if(!e[0].length){var n=e[1];k("keydown",e[2],n)}})}}(e,t)},E=function(e){var t=n[e],r=d[t]&&d[t].indexOf(e);r>=0&&d[t].splice(r,1),k("keyup",t,e)},b={register:function(){var e=function(e){Object.keys(p).length||(l.on("keydown",g),l.on("keyup",E));var t=y[e];if(t&&(clearTimeout(t),d[e]=[]),k>=0&&(m.set(b,k),i.length)){i.forEach(function(t){n[t]===e&&(d[e]||(d[e]=[]),d[e].push(t))});var r=d[e];r&&r.length&&(y[e]=setTimeout(function(){d[e].forEach(function(e){g(e)}),delete d[e]},k))}var o=p[e];if(o)if(v){var a=o.length;a?o[a-1].push(b):o.push([b])}else o.push([b]);else p[e]=[[b]]},a=function(){for(var e,n,t,o,i=0,a=arguments.length,u=new Array(a),c=0;c<a;c++)u[c]=arguments[c];return Array.isArray(u[0])&&(e=u[0],i++),r(u[i])&&(n=u[i].propagate,t=u[i].reEmit),"function"==typeof u[u.length-1]&&(o=u[u.length-1]),{keyNames:e,propagate:n,reEmit:t,callback:o}}.apply(void 0,arguments),c=a.keyNames,f=void 0===c?o(Object.values(n)):c,s=a.propagate,v=void 0===s?t:s,h=a.reEmit,k=void 0===h?u:h,b=a.callback;if(f&&b){var N=f,A=Array.isArray(N),w=0;for(N=A?N:N[Symbol.iterator]();;){var O;if(A){if(w>=N.length)break;O=N[w++]}else{if((w=N.next()).done)break;O=w.value}e(O)}}},unregister:function(){var e=function(e){if(p&&p[e])for(var t=p[e].length-1,r=t;r>=0;r--){var o=p[e][r],u=o.indexOf(a);if(u>=0){if(r===t&&u===o.length-1){var c=y[e];if(c&&(clearTimeout(c),y[e]=0),i.length){var f=o[o.length-2];if(f){var s=m.get(f);if(d[e]=[],s>=0){i.forEach(function(t){n[t]===e&&(d[e]||(d[e]=[]),d[e].push(t))});var v=d[e];v&&v.length&&(y[e]=setTimeout(function(){d.forEach(function(e){g(e)})},s))}}}}return p[e][r].splice(u,1),void(o.length||(p[e].splice(r,1),p[e].length||delete p[e],Object.keys(p).length||(l.off("keydown",g),l.off("keyup",E))))}}},t=function(){var e,t,r,i;t=Array.isArray(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:o(Object.values(n)),"function"==typeof((e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e])&&(r=(i=arguments.length-1)<0||arguments.length<=i?void 0:arguments[i]);return{keyNames:t,callback:r}}.apply(void 0,arguments),r=t.keyNames,a=t.callback;if(a&&r){var u=r,c=Array.isArray(u),f=0;for(u=c?u:u[Symbol.iterator]();;){var s;if(c){if(f>=u.length)break;s=u[f++]}else{if((f=u.next()).done)break;s=f.value}e(s)}}},close:function(){return l.close()}};return b},d=config,y=d.DEFAULT_COMBINE_VALUE,m=d.DEFAULT_PROPAGATE_VALUE,h=d.DEFAULT_REEMIT_TIMEOUT,k=d.DEFAULT_PREVENT_DEFAULT,g="push",E="release",b="press",N=function(e){void 0===e&&(e={});var n=e.keyMap||v.KEY_MAP,t=e.groupings||v.GROUPINGS,a=r(e.combine)?e.combine:y,u=r(e.propagate)?e.propagate:m,c=r(e.reEmit)?e.reEmit:h,f=r(e.preventDefault)?e.preventDefault:k,l=p({keyMap:n,propagate:u,reEmit:c,preventDefault:f}),d={},N=s(Object.keys(n).map(function(e){return+e}));return{listen:function(){for(var e=arguments.length,f=new Array(e),s=0;s<e;s++)f[s]=arguments[s];var v,p=A.apply(void 0,[t].concat(f)),y=p.keys,m=void 0===y?o(Object.values(n)):y,h=p.options,k=void 0===h?{}:h,O=p.callbackNext,P=void 0===O?function(){}:O,L=w(k),T=L.pressIntervals,D=L.reEmit,_=void 0===D?c:D,U=L.propagate,j=void 0===U?u:U,x=L.combine,S=void 0===x?a:x,I=Object.keys(n).filter(function(e){return m.includes(n[e])}).reduce(function(e,t){return e[t]={keyName:n[t],isPushed:!1,pushStart:null,currentPressInterval:0,interval:null,timeouts:[]},e},{}),R=function(e){if(e.timeouts.forEach(function(e){return clearTimeout(e)}),e.timeouts=[],e.interval&&(clearInterval(e.interval),e.interval=0),d[e.keyName]){var n=d[e.keyName],t=n.indexOf(e);d[e.keyName].splice(t,1),n.length||delete d[e.keyName]}},M=function(e,n){var t=n.keyName,o=n.currentPressInterval,i=n.pushStart,a=r(i)?performance.now()-i:0;P.call(e,{keyName:t,event:b,pressInterval:o,timepress:a})},C=function(e){if(m.includes(e.keyName))switch(e.type){case"keydown":V(this,e);break;case"keyup":K(this,e)}},F=function(e,n){if(r(T)){var t=d[n.keyName];d[n.keyName]=t?t.push(n):[n];T.forEach(function(t){n.timeouts.push(function(t){return setTimeout(function(){n.interval&&clearInterval(n.interval),r(t.interval)?n.interval=setInterval(function(){M(e,n)},t.interval):n.interval=null,n.currentPressInterval++,M(e,n)},t.after)}(t))})}},V=function(e,n){var t=n.keyCode,r=I[t];if(!r.isPushed&&i[i.length-1]===t){var o={stopPropagation:e.stopPropagation};F(o,r),r.isPushed=!0,r.pushStart=performance.now(),function(e,n){var t=n.keyName;P.call(e,{keyName:t,event:g,pressInterval:0,timepress:0})}(o,r)}},K=function(e,n){var t=n.keyCode,o=I[t];o.isPushed&&(R(o),function(e,n){var t=n.keyName,o=n.currentPressInterval,i=n.pushStart,a=r(i)?performance.now()-i:0;P.call(e,{keyName:t,event:E,pressInterval:o,timepress:a})}({stopPropagation:e.stopPropagation},o),o.isPushed=!1,o.pushStart=null)};return S||(v=function(){Object.values(I).forEach(function(e){return R(e)})},N.on("keydown",v)),j||m.forEach(function(e){d[e]&&d[e].forEach(function(e){R(e)})}),l.register(m,{propagate:j,reEmit:_},C),function(){S||N.off("keydown",v);for(var e=0,n=Object.keys(I);e<n.length;e++){var t=n[e];R(I[t])}l.unregister(m,C)}},close:function(){l.close()}}},A=function(e){var n,t,o,i=function(n){return n.reduce(function(n,t){return Object.keys(e).includes(t)?n.concat(e[t]):(n.push(t),n)},[])},a=arguments.length<=1?0:arguments.length-1,u=0,c=u+1<1||arguments.length<=u+1?void 0:arguments[u+1];return Array.isArray(c)?(n=i(c),c=++u+1<1||arguments.length<=u+1?void 0:arguments[u+1]):"string"==typeof c?(n=i([c]),c=++u+1<1||arguments.length<=u+1?void 0:arguments[u+1]):!r(c)&&a-1>u&&(c=++u+1<1||arguments.length<=u+1?void 0:arguments[u+1]),"object"==typeof c&&null!==c?(t=c,c=++u+1<1||arguments.length<=u+1?void 0:arguments[u+1]):!r(c)&&a-1>u&&(c=++u+1<1||arguments.length<=u+1?void 0:arguments[u+1]),"function"==typeof c&&(o=c),{keys:n,options:t,callbackNext:o}},w=function(e){var n,t,o=e.propagate,i=e.combine,a=e.reEmit,u=e.press;if(r(u))if(Array.isArray(u))n=function(e){for(var n=e.length,t=0;t<n;t++){if(e[t]={after:+e[t].after,interval:+e[t].interval},isNaN(e[t].after)){if(isNaN(e[t].interval)){e.splice(t,1),t--;continue}e[t].after=e[t].interval}else isNaN(e[t].interval)&&delete e[t].interval;for(var r=t;r>0&&e[r-1].after>e[r].after;){var o=e[r];e[r]=e[r-1],e[r-1]=o}}return e}(u);else{var c=+u.after,f=+u.interval;isNaN(c)?isNaN(f)||(n=[{after:f,interval:f}]):n=isNaN(f)?[{after:c}]:[{after:c,interval:f}]}if(r(a)){var l=+a;isNaN(l)||(t=l)}return{pressIntervals:n,combine:i,reEmit:t,propagate:o}},O={create:function(){var e=N();return function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return e.apply(void 0,t.concat(function(n){return function(t){return t.next(n),e()}}))}}};var P,L,T,D=(L=N(P),T=function(e,n){return e&&e(n)},{listen:function(){var e=function(e,n){return Array.isArray(e)||"string"==typeof e?{keys:e,options:n}:{options:e}}.apply(void 0,arguments),n=e.keys,t=e.options,r=void 0===t?{}:t,o=r.onPush,i=r.onRelease,a=r.onPress,u=r.onDown,c=r.onEvent,f=r.onUnbind,l=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(r,["onPush","onRelease","onPress","onDown","onEvent","onUnbind"]),s=L.listen(n,l,function(e){switch(e.event){case"push":T(o,e),T(u,e);break;case"press":T(a,e),T(u,e);break;case"release":T(i,e)}T(c,e)});return{unbind:function(){T(f),s()}}},free:function(){L.close()}});t.d(n,"RKeyboard",function(){return D}),t.d(n,"RxKeyboard",function(){return O}),t.d(n,"createKeyboard",function(){return N}),window.RKeyboard=D;n.default=D}])});